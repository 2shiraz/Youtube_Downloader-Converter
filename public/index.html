<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script
      src="https://kit.fontawesome.com/6f9db9e598.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="index.css" />
    <title>Document</title>
  </head>
  <body>
    <div class="container">
    <form action="#">
      <header>Download Thumbnail</header>
      <div class="url-input">
        <span class="title">Paste video url:</span>
        <div class="field">
          <input
            type="text"
            placeholder="https://www.youtube.com/watch?v=t3E-niqGutM"
            required
          />
          <input type="hidden" class="hidden-input" />
          <div class="bottom-line"></div>
        </div>
      </div>
      <div class="preview-area">
        <img src="img.jpg" alt="thumbnail" class="thumbnail" />
        <i class="icon fas fa-cloud-download-alt"></i>
        <span>Paste video url to see preview</span>
      </div>

      <button class="download-btn" name="download" onclick="" id="button">
        Download Thumbnail
      </button>
    </form>
  <div>
    <h1 class="heading">My Own YouTube Downloader !</h1>
    <form action="/youtube" method="post">
    <input
      name="url"
      class="URL-input"
      placeholder="Video URL e.g. https://www.youtube.com/watch?v=MtN1YnoL46Q"
     
    />
    <button type="submit" class="convert-button">Convert</button>
  </form>
  </div>

  </div>

    <script>
      const urlField = document.querySelector(".field input");
      const previewArea = document.querySelector(".preview-area");
      console.log(previewArea);
      const imgTag = previewArea.querySelector(".thumbnail");
      console.log(imgTag);
      const hiddenInput = previewArea.querySelector("hidden-input");
      const button = document.getElementById("button");

      button.addEventListener("click", function () {
        let link = document.getElementById("download");
        console.log(link);
        link.click();
        link.remove();
      });

      function downloadURI(uri) {
        let link = document.createElement("a");
        // If you don't know the name or want to use
        // the webserver default set name = ''
        link.id = "download";
        link.download = "";
        link.target = "_blank";
        link.href = uri;
        document.body.appendChild(link);
      }

      urlField.onkeyup = () => {
        let imgUrl = urlField.value; //getting user entered value
        console.log(imgUrl);
        previewArea.classList.add("active");

        if (imgUrl.indexOf("https://www.youtube.com/watch?v=") != -1) {
          //if entered vlue is yt video url
          let vidId = imgUrl.split("v=")[1].substring(0, 11); //splitting yt video url from v= so we can get only video ID
          console.log(vidId);
          let ytThumbUrl = `https://img.youtube.com/vi/${vidId}/maxresdefault.jpg`; //passing entred url video id inside
          console.log(ytThumbUrl);
          imgTag.src = ytThumbUrl;
          downloadURI(ytThumbUrl);
        } else if (imgUrl.indexOf("https://youtu.be") != -1) {
          //if video url looks like this
          let vidId = imgUrl.split("be/")[1].substring(0, 11);
          let ytImgUrl = `https://img.youtube.com/vi/${vidId}/maxresdefault.jpg`;
          imgTag.src = ytImgUrl;
        } else if (imgUrl.match(/\.(jpe?g|png|gif|bmp|webp)$/i)) {
          //if entered value is other image file url
          imgTag.src = imgUrl; //passing user entered url inside img src
        } else {
          imgTag.src = "";
          previewArea.classList.remove("active");
        }
      };
    </script>
    <script src='script.js'></script>
  </body>
</html>
